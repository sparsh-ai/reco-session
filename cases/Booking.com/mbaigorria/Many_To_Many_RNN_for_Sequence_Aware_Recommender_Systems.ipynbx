{
  "nbformat": 4,
  "nbformat_minor": 0,
  "metadata": {
    "colab": {
      "name": "Many-To-Many RNN for Sequence-Aware Recommender Systems.ipynb",
      "provenance": [],
      "collapsed_sections": [],
      "toc_visible": true,
      "machine_shape": "hm"
    },
    "kernelspec": {
      "name": "python3",
      "display_name": "Python 3"
    },
    "accelerator": "GPU",
    "widgets": {
      "application/vnd.jupyter.widget-state+json": {
        "14a6ef44c70d4cb98281b68210c0b3c7": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "state": {
            "_view_name": "HBoxView",
            "_dom_classes": [],
            "_model_name": "HBoxModel",
            "_view_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_view_count": null,
            "_view_module_version": "1.5.0",
            "box_style": "",
            "layout": "IPY_MODEL_6d5d85fe7e0346609dfb32dbab8f5a94",
            "_model_module": "@jupyter-widgets/controls",
            "children": [
              "IPY_MODEL_06a9838bca3a4ef59a44c4c1484e67ed",
              "IPY_MODEL_e6f6e425d87a4bd5868dcdd929ed64e3",
              "IPY_MODEL_44a5f22451014029ba0e7b9b38a007b1"
            ]
          }
        },
        "6d5d85fe7e0346609dfb32dbab8f5a94": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "state": {
            "_view_name": "LayoutView",
            "grid_template_rows": null,
            "right": null,
            "justify_content": null,
            "_view_module": "@jupyter-widgets/base",
            "overflow": null,
            "_model_module_version": "1.2.0",
            "_view_count": null,
            "flex_flow": null,
            "width": null,
            "min_width": null,
            "border": null,
            "align_items": null,
            "bottom": null,
            "_model_module": "@jupyter-widgets/base",
            "top": null,
            "grid_column": null,
            "overflow_y": null,
            "overflow_x": null,
            "grid_auto_flow": null,
            "grid_area": null,
            "grid_template_columns": null,
            "flex": null,
            "_model_name": "LayoutModel",
            "justify_items": null,
            "grid_row": null,
            "max_height": null,
            "align_content": null,
            "visibility": null,
            "align_self": null,
            "height": null,
            "min_height": null,
            "padding": null,
            "grid_auto_rows": null,
            "grid_gap": null,
            "max_width": null,
            "order": null,
            "_view_module_version": "1.2.0",
            "grid_template_areas": null,
            "object_position": null,
            "object_fit": null,
            "grid_auto_columns": null,
            "margin": null,
            "display": null,
            "left": null
          }
        },
        "06a9838bca3a4ef59a44c4c1484e67ed": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "state": {
            "_view_name": "HTMLView",
            "style": "IPY_MODEL_571c0be7334c4318bf8f3b0219eb0b5e",
            "_dom_classes": [],
            "description": "",
            "_model_name": "HTMLModel",
            "placeholder": "​",
            "_view_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "value": "100%",
            "_view_count": null,
            "_view_module_version": "1.5.0",
            "description_tooltip": null,
            "_model_module": "@jupyter-widgets/controls",
            "layout": "IPY_MODEL_68f45a493cc449a591dbe637c87e5e07"
          }
        },
        "e6f6e425d87a4bd5868dcdd929ed64e3": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "state": {
            "_view_name": "ProgressView",
            "style": "IPY_MODEL_dfa954117de64aa28609d63fa973b157",
            "_dom_classes": [],
            "description": "",
            "_model_name": "FloatProgressModel",
            "bar_style": "success",
            "max": 282628,
            "_view_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "value": 282628,
            "_view_count": null,
            "_view_module_version": "1.5.0",
            "orientation": "horizontal",
            "min": 0,
            "description_tooltip": null,
            "_model_module": "@jupyter-widgets/controls",
            "layout": "IPY_MODEL_75cf9b62514d4147858187194aa820f2"
          }
        },
        "44a5f22451014029ba0e7b9b38a007b1": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "state": {
            "_view_name": "HTMLView",
            "style": "IPY_MODEL_0f807a7f15bc47b48fe761386f808812",
            "_dom_classes": [],
            "description": "",
            "_model_name": "HTMLModel",
            "placeholder": "​",
            "_view_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "value": " 282628/282628 [06:14&lt;00:00, 796.88it/s]",
            "_view_count": null,
            "_view_module_version": "1.5.0",
            "description_tooltip": null,
            "_model_module": "@jupyter-widgets/controls",
            "layout": "IPY_MODEL_39c738da42274e3fb9bb975fcec1d1bc"
          }
        },
        "571c0be7334c4318bf8f3b0219eb0b5e": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "state": {
            "_view_name": "StyleView",
            "_model_name": "DescriptionStyleModel",
            "description_width": "",
            "_view_module": "@jupyter-widgets/base",
            "_model_module_version": "1.5.0",
            "_view_count": null,
            "_view_module_version": "1.2.0",
            "_model_module": "@jupyter-widgets/controls"
          }
        },
        "68f45a493cc449a591dbe637c87e5e07": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "state": {
            "_view_name": "LayoutView",
            "grid_template_rows": null,
            "right": null,
            "justify_content": null,
            "_view_module": "@jupyter-widgets/base",
            "overflow": null,
            "_model_module_version": "1.2.0",
            "_view_count": null,
            "flex_flow": null,
            "width": null,
            "min_width": null,
            "border": null,
            "align_items": null,
            "bottom": null,
            "_model_module": "@jupyter-widgets/base",
            "top": null,
            "grid_column": null,
            "overflow_y": null,
            "overflow_x": null,
            "grid_auto_flow": null,
            "grid_area": null,
            "grid_template_columns": null,
            "flex": null,
            "_model_name": "LayoutModel",
            "justify_items": null,
            "grid_row": null,
            "max_height": null,
            "align_content": null,
            "visibility": null,
            "align_self": null,
            "height": null,
            "min_height": null,
            "padding": null,
            "grid_auto_rows": null,
            "grid_gap": null,
            "max_width": null,
            "order": null,
            "_view_module_version": "1.2.0",
            "grid_template_areas": null,
            "object_position": null,
            "object_fit": null,
            "grid_auto_columns": null,
            "margin": null,
            "display": null,
            "left": null
          }
        },
        "dfa954117de64aa28609d63fa973b157": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "state": {
            "_view_name": "StyleView",
            "_model_name": "ProgressStyleModel",
            "description_width": "",
            "_view_module": "@jupyter-widgets/base",
            "_model_module_version": "1.5.0",
            "_view_count": null,
            "_view_module_version": "1.2.0",
            "bar_color": null,
            "_model_module": "@jupyter-widgets/controls"
          }
        },
        "75cf9b62514d4147858187194aa820f2": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "state": {
            "_view_name": "LayoutView",
            "grid_template_rows": null,
            "right": null,
            "justify_content": null,
            "_view_module": "@jupyter-widgets/base",
            "overflow": null,
            "_model_module_version": "1.2.0",
            "_view_count": null,
            "flex_flow": null,
            "width": null,
            "min_width": null,
            "border": null,
            "align_items": null,
            "bottom": null,
            "_model_module": "@jupyter-widgets/base",
            "top": null,
            "grid_column": null,
            "overflow_y": null,
            "overflow_x": null,
            "grid_auto_flow": null,
            "grid_area": null,
            "grid_template_columns": null,
            "flex": null,
            "_model_name": "LayoutModel",
            "justify_items": null,
            "grid_row": null,
            "max_height": null,
            "align_content": null,
            "visibility": null,
            "align_self": null,
            "height": null,
            "min_height": null,
            "padding": null,
            "grid_auto_rows": null,
            "grid_gap": null,
            "max_width": null,
            "order": null,
            "_view_module_version": "1.2.0",
            "grid_template_areas": null,
            "object_position": null,
            "object_fit": null,
            "grid_auto_columns": null,
            "margin": null,
            "display": null,
            "left": null
          }
        },
        "0f807a7f15bc47b48fe761386f808812": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "state": {
            "_view_name": "StyleView",
            "_model_name": "DescriptionStyleModel",
            "description_width": "",
            "_view_module": "@jupyter-widgets/base",
            "_model_module_version": "1.5.0",
            "_view_count": null,
            "_view_module_version": "1.2.0",
            "_model_module": "@jupyter-widgets/controls"
          }
        },
        "39c738da42274e3fb9bb975fcec1d1bc": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "state": {
            "_view_name": "LayoutView",
            "grid_template_rows": null,
            "right": null,
            "justify_content": null,
            "_view_module": "@jupyter-widgets/base",
            "overflow": null,
            "_model_module_version": "1.2.0",
            "_view_count": null,
            "flex_flow": null,
            "width": null,
            "min_width": null,
            "border": null,
            "align_items": null,
            "bottom": null,
            "_model_module": "@jupyter-widgets/base",
            "top": null,
            "grid_column": null,
            "overflow_y": null,
            "overflow_x": null,
            "grid_auto_flow": null,
            "grid_area": null,
            "grid_template_columns": null,
            "flex": null,
            "_model_name": "LayoutModel",
            "justify_items": null,
            "grid_row": null,
            "max_height": null,
            "align_content": null,
            "visibility": null,
            "align_self": null,
            "height": null,
            "min_height": null,
            "padding": null,
            "grid_auto_rows": null,
            "grid_gap": null,
            "max_width": null,
            "order": null,
            "_view_module_version": "1.2.0",
            "grid_template_areas": null,
            "object_position": null,
            "object_fit": null,
            "grid_auto_columns": null,
            "margin": null,
            "display": null,
            "left": null
          }
        },
        "2a5f7cf508214ef8bac7bde4805da3a4": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "state": {
            "_view_name": "HBoxView",
            "_dom_classes": [],
            "_model_name": "HBoxModel",
            "_view_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_view_count": null,
            "_view_module_version": "1.5.0",
            "box_style": "",
            "layout": "IPY_MODEL_c41042eec09147c6a45da7f018881e38",
            "_model_module": "@jupyter-widgets/controls",
            "children": [
              "IPY_MODEL_e8b466f87e6849e0a2460750629f51e3",
              "IPY_MODEL_044b0b8a2e1b48629f9a576426bdbf0e",
              "IPY_MODEL_288dded8872641dfbf1778871931a0b1"
            ]
          }
        },
        "c41042eec09147c6a45da7f018881e38": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "state": {
            "_view_name": "LayoutView",
            "grid_template_rows": null,
            "right": null,
            "justify_content": null,
            "_view_module": "@jupyter-widgets/base",
            "overflow": null,
            "_model_module_version": "1.2.0",
            "_view_count": null,
            "flex_flow": null,
            "width": null,
            "min_width": null,
            "border": null,
            "align_items": null,
            "bottom": null,
            "_model_module": "@jupyter-widgets/base",
            "top": null,
            "grid_column": null,
            "overflow_y": null,
            "overflow_x": null,
            "grid_auto_flow": null,
            "grid_area": null,
            "grid_template_columns": null,
            "flex": null,
            "_model_name": "LayoutModel",
            "justify_items": null,
            "grid_row": null,
            "max_height": null,
            "align_content": null,
            "visibility": null,
            "align_self": null,
            "height": null,
            "min_height": null,
            "padding": null,
            "grid_auto_rows": null,
            "grid_gap": null,
            "max_width": null,
            "order": null,
            "_view_module_version": "1.2.0",
            "grid_template_areas": null,
            "object_position": null,
            "object_fit": null,
            "grid_auto_columns": null,
            "margin": null,
            "display": null,
            "left": null
          }
        },
        "e8b466f87e6849e0a2460750629f51e3": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "state": {
            "_view_name": "HTMLView",
            "style": "IPY_MODEL_877a516afd0d4e38ab4b0eb7b3b38531",
            "_dom_classes": [],
            "description": "",
            "_model_name": "HTMLModel",
            "placeholder": "​",
            "_view_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "value": "100%",
            "_view_count": null,
            "_view_module_version": "1.5.0",
            "description_tooltip": null,
            "_model_module": "@jupyter-widgets/controls",
            "layout": "IPY_MODEL_f1e85767b60541ec88ebf5150b6765c3"
          }
        },
        "044b0b8a2e1b48629f9a576426bdbf0e": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "state": {
            "_view_name": "ProgressView",
            "style": "IPY_MODEL_52296aad7771447e9b8006f1a583aa3f",
            "_dom_classes": [],
            "description": "",
            "_model_name": "FloatProgressModel",
            "bar_style": "success",
            "max": 50,
            "_view_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "value": 50,
            "_view_count": null,
            "_view_module_version": "1.5.0",
            "orientation": "horizontal",
            "min": 0,
            "description_tooltip": null,
            "_model_module": "@jupyter-widgets/controls",
            "layout": "IPY_MODEL_732a2844209b48828168dd643c97a135"
          }
        },
        "288dded8872641dfbf1778871931a0b1": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "state": {
            "_view_name": "HTMLView",
            "style": "IPY_MODEL_589be6fd7fff4831bd19530f0caed3a9",
            "_dom_classes": [],
            "description": "",
            "_model_name": "HTMLModel",
            "placeholder": "​",
            "_view_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "value": " 50/50 [09:30&lt;00:00, 11.47s/it]",
            "_view_count": null,
            "_view_module_version": "1.5.0",
            "description_tooltip": null,
            "_model_module": "@jupyter-widgets/controls",
            "layout": "IPY_MODEL_d6eacede507341b38177b205bdb32846"
          }
        },
        "877a516afd0d4e38ab4b0eb7b3b38531": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "state": {
            "_view_name": "StyleView",
            "_model_name": "DescriptionStyleModel",
            "description_width": "",
            "_view_module": "@jupyter-widgets/base",
            "_model_module_version": "1.5.0",
            "_view_count": null,
            "_view_module_version": "1.2.0",
            "_model_module": "@jupyter-widgets/controls"
          }
        },
        "f1e85767b60541ec88ebf5150b6765c3": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "state": {
            "_view_name": "LayoutView",
            "grid_template_rows": null,
            "right": null,
            "justify_content": null,
            "_view_module": "@jupyter-widgets/base",
            "overflow": null,
            "_model_module_version": "1.2.0",
            "_view_count": null,
            "flex_flow": null,
            "width": null,
            "min_width": null,
            "border": null,
            "align_items": null,
            "bottom": null,
            "_model_module": "@jupyter-widgets/base",
            "top": null,
            "grid_column": null,
            "overflow_y": null,
            "overflow_x": null,
            "grid_auto_flow": null,
            "grid_area": null,
            "grid_template_columns": null,
            "flex": null,
            "_model_name": "LayoutModel",
            "justify_items": null,
            "grid_row": null,
            "max_height": null,
            "align_content": null,
            "visibility": null,
            "align_self": null,
            "height": null,
            "min_height": null,
            "padding": null,
            "grid_auto_rows": null,
            "grid_gap": null,
            "max_width": null,
            "order": null,
            "_view_module_version": "1.2.0",
            "grid_template_areas": null,
            "object_position": null,
            "object_fit": null,
            "grid_auto_columns": null,
            "margin": null,
            "display": null,
            "left": null
          }
        },
        "52296aad7771447e9b8006f1a583aa3f": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "state": {
            "_view_name": "StyleView",
            "_model_name": "ProgressStyleModel",
            "description_width": "",
            "_view_module": "@jupyter-widgets/base",
            "_model_module_version": "1.5.0",
            "_view_count": null,
            "_view_module_version": "1.2.0",
            "bar_color": null,
            "_model_module": "@jupyter-widgets/controls"
          }
        },
        "732a2844209b48828168dd643c97a135": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "state": {
            "_view_name": "LayoutView",
            "grid_template_rows": null,
            "right": null,
            "justify_content": null,
            "_view_module": "@jupyter-widgets/base",
            "overflow": null,
            "_model_module_version": "1.2.0",
            "_view_count": null,
            "flex_flow": null,
            "width": null,
            "min_width": null,
            "border": null,
            "align_items": null,
            "bottom": null,
            "_model_module": "@jupyter-widgets/base",
            "top": null,
            "grid_column": null,
            "overflow_y": null,
            "overflow_x": null,
            "grid_auto_flow": null,
            "grid_area": null,
            "grid_template_columns": null,
            "flex": null,
            "_model_name": "LayoutModel",
            "justify_items": null,
            "grid_row": null,
            "max_height": null,
            "align_content": null,
            "visibility": null,
            "align_self": null,
            "height": null,
            "min_height": null,
            "padding": null,
            "grid_auto_rows": null,
            "grid_gap": null,
            "max_width": null,
            "order": null,
            "_view_module_version": "1.2.0",
            "grid_template_areas": null,
            "object_position": null,
            "object_fit": null,
            "grid_auto_columns": null,
            "margin": null,
            "display": null,
            "left": null
          }
        },
        "589be6fd7fff4831bd19530f0caed3a9": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "state": {
            "_view_name": "StyleView",
            "_model_name": "DescriptionStyleModel",
            "description_width": "",
            "_view_module": "@jupyter-widgets/base",
            "_model_module_version": "1.5.0",
            "_view_count": null,
            "_view_module_version": "1.2.0",
            "_model_module": "@jupyter-widgets/controls"
          }
        },
        "d6eacede507341b38177b205bdb32846": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "state": {
            "_view_name": "LayoutView",
            "grid_template_rows": null,
            "right": null,
            "justify_content": null,
            "_view_module": "@jupyter-widgets/base",
            "overflow": null,
            "_model_module_version": "1.2.0",
            "_view_count": null,
            "flex_flow": null,
            "width": null,
            "min_width": null,
            "border": null,
            "align_items": null,
            "bottom": null,
            "_model_module": "@jupyter-widgets/base",
            "top": null,
            "grid_column": null,
            "overflow_y": null,
            "overflow_x": null,
            "grid_auto_flow": null,
            "grid_area": null,
            "grid_template_columns": null,
            "flex": null,
            "_model_name": "LayoutModel",
            "justify_items": null,
            "grid_row": null,
            "max_height": null,
            "align_content": null,
            "visibility": null,
            "align_self": null,
            "height": null,
            "min_height": null,
            "padding": null,
            "grid_auto_rows": null,
            "grid_gap": null,
            "max_width": null,
            "order": null,
            "_view_module_version": "1.2.0",
            "grid_template_areas": null,
            "object_position": null,
            "object_fit": null,
            "grid_auto_columns": null,
            "margin": null,
            "display": null,
            "left": null
          }
        },
        "37ada2063da14a9d9fb63a58488a1b6b": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "state": {
            "_view_name": "HBoxView",
            "_dom_classes": [],
            "_model_name": "HBoxModel",
            "_view_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_view_count": null,
            "_view_module_version": "1.5.0",
            "box_style": "",
            "layout": "IPY_MODEL_c0b28de6b5254a5ca764450659f91f7d",
            "_model_module": "@jupyter-widgets/controls",
            "children": [
              "IPY_MODEL_9cf9c28d13bb4adb886d0a10e771c7db",
              "IPY_MODEL_01b0eab7072c4fcc94c34102b474e0e0",
              "IPY_MODEL_7b154958d1c744979744841699a14c39"
            ]
          }
        },
        "c0b28de6b5254a5ca764450659f91f7d": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "state": {
            "_view_name": "LayoutView",
            "grid_template_rows": null,
            "right": null,
            "justify_content": null,
            "_view_module": "@jupyter-widgets/base",
            "overflow": null,
            "_model_module_version": "1.2.0",
            "_view_count": null,
            "flex_flow": null,
            "width": null,
            "min_width": null,
            "border": null,
            "align_items": null,
            "bottom": null,
            "_model_module": "@jupyter-widgets/base",
            "top": null,
            "grid_column": null,
            "overflow_y": null,
            "overflow_x": null,
            "grid_auto_flow": null,
            "grid_area": null,
            "grid_template_columns": null,
            "flex": null,
            "_model_name": "LayoutModel",
            "justify_items": null,
            "grid_row": null,
            "max_height": null,
            "align_content": null,
            "visibility": null,
            "align_self": null,
            "height": null,
            "min_height": null,
            "padding": null,
            "grid_auto_rows": null,
            "grid_gap": null,
            "max_width": null,
            "order": null,
            "_view_module_version": "1.2.0",
            "grid_template_areas": null,
            "object_position": null,
            "object_fit": null,
            "grid_auto_columns": null,
            "margin": null,
            "display": null,
            "left": null
          }
        },
        "9cf9c28d13bb4adb886d0a10e771c7db": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "state": {
            "_view_name": "HTMLView",
            "style": "IPY_MODEL_7bbe4c6f94504c7298aed108b337636c",
            "_dom_classes": [],
            "description": "",
            "_model_name": "HTMLModel",
            "placeholder": "​",
            "_view_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "value": "100%",
            "_view_count": null,
            "_view_module_version": "1.5.0",
            "description_tooltip": null,
            "_model_module": "@jupyter-widgets/controls",
            "layout": "IPY_MODEL_276ca60861984fa395638bfebb3defcd"
          }
        },
        "01b0eab7072c4fcc94c34102b474e0e0": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "state": {
            "_view_name": "ProgressView",
            "style": "IPY_MODEL_5ff969a3233a4744926b19261e0ca545",
            "_dom_classes": [],
            "description": "",
            "_model_name": "FloatProgressModel",
            "bar_style": "success",
            "max": 5588,
            "_view_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "value": 5588,
            "_view_count": null,
            "_view_module_version": "1.5.0",
            "orientation": "horizontal",
            "min": 0,
            "description_tooltip": null,
            "_model_module": "@jupyter-widgets/controls",
            "layout": "IPY_MODEL_b980f1569596476692f3329ac30ec60d"
          }
        },
        "7b154958d1c744979744841699a14c39": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "state": {
            "_view_name": "HTMLView",
            "style": "IPY_MODEL_1fa23d0a28314588b779beabba577ac4",
            "_dom_classes": [],
            "description": "",
            "_model_name": "HTMLModel",
            "placeholder": "​",
            "_view_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "value": " 5588/5588 [00:07&lt;00:00, 779.69it/s]",
            "_view_count": null,
            "_view_module_version": "1.5.0",
            "description_tooltip": null,
            "_model_module": "@jupyter-widgets/controls",
            "layout": "IPY_MODEL_f406480c1765418483ea1b768298fb31"
          }
        },
        "7bbe4c6f94504c7298aed108b337636c": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "state": {
            "_view_name": "StyleView",
            "_model_name": "DescriptionStyleModel",
            "description_width": "",
            "_view_module": "@jupyter-widgets/base",
            "_model_module_version": "1.5.0",
            "_view_count": null,
            "_view_module_version": "1.2.0",
            "_model_module": "@jupyter-widgets/controls"
          }
        },
        "276ca60861984fa395638bfebb3defcd": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "state": {
            "_view_name": "LayoutView",
            "grid_template_rows": null,
            "right": null,
            "justify_content": null,
            "_view_module": "@jupyter-widgets/base",
            "overflow": null,
            "_model_module_version": "1.2.0",
            "_view_count": null,
            "flex_flow": null,
            "width": null,
            "min_width": null,
            "border": null,
            "align_items": null,
            "bottom": null,
            "_model_module": "@jupyter-widgets/base",
            "top": null,
            "grid_column": null,
            "overflow_y": null,
            "overflow_x": null,
            "grid_auto_flow": null,
            "grid_area": null,
            "grid_template_columns": null,
            "flex": null,
            "_model_name": "LayoutModel",
            "justify_items": null,
            "grid_row": null,
            "max_height": null,
            "align_content": null,
            "visibility": null,
            "align_self": null,
            "height": null,
            "min_height": null,
            "padding": null,
            "grid_auto_rows": null,
            "grid_gap": null,
            "max_width": null,
            "order": null,
            "_view_module_version": "1.2.0",
            "grid_template_areas": null,
            "object_position": null,
            "object_fit": null,
            "grid_auto_columns": null,
            "margin": null,
            "display": null,
            "left": null
          }
        },
        "5ff969a3233a4744926b19261e0ca545": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "state": {
            "_view_name": "StyleView",
            "_model_name": "ProgressStyleModel",
            "description_width": "",
            "_view_module": "@jupyter-widgets/base",
            "_model_module_version": "1.5.0",
            "_view_count": null,
            "_view_module_version": "1.2.0",
            "bar_color": null,
            "_model_module": "@jupyter-widgets/controls"
          }
        },
        "b980f1569596476692f3329ac30ec60d": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "state": {
            "_view_name": "LayoutView",
            "grid_template_rows": null,
            "right": null,
            "justify_content": null,
            "_view_module": "@jupyter-widgets/base",
            "overflow": null,
            "_model_module_version": "1.2.0",
            "_view_count": null,
            "flex_flow": null,
            "width": null,
            "min_width": null,
            "border": null,
            "align_items": null,
            "bottom": null,
            "_model_module": "@jupyter-widgets/base",
            "top": null,
            "grid_column": null,
            "overflow_y": null,
            "overflow_x": null,
            "grid_auto_flow": null,
            "grid_area": null,
            "grid_template_columns": null,
            "flex": null,
            "_model_name": "LayoutModel",
            "justify_items": null,
            "grid_row": null,
            "max_height": null,
            "align_content": null,
            "visibility": null,
            "align_self": null,
            "height": null,
            "min_height": null,
            "padding": null,
            "grid_auto_rows": null,
            "grid_gap": null,
            "max_width": null,
            "order": null,
            "_view_module_version": "1.2.0",
            "grid_template_areas": null,
            "object_position": null,
            "object_fit": null,
            "grid_auto_columns": null,
            "margin": null,
            "display": null,
            "left": null
          }
        },
        "1fa23d0a28314588b779beabba577ac4": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "state": {
            "_view_name": "StyleView",
            "_model_name": "DescriptionStyleModel",
            "description_width": "",
            "_view_module": "@jupyter-widgets/base",
            "_model_module_version": "1.5.0",
            "_view_count": null,
            "_view_module_version": "1.2.0",
            "_model_module": "@jupyter-widgets/controls"
          }
        },
        "f406480c1765418483ea1b768298fb31": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "state": {
            "_view_name": "LayoutView",
            "grid_template_rows": null,
            "right": null,
            "justify_content": null,
            "_view_module": "@jupyter-widgets/base",
            "overflow": null,
            "_model_module_version": "1.2.0",
            "_view_count": null,
            "flex_flow": null,
            "width": null,
            "min_width": null,
            "border": null,
            "align_items": null,
            "bottom": null,
            "_model_module": "@jupyter-widgets/base",
            "top": null,
            "grid_column": null,
            "overflow_y": null,
            "overflow_x": null,
            "grid_auto_flow": null,
            "grid_area": null,
            "grid_template_columns": null,
            "flex": null,
            "_model_name": "LayoutModel",
            "justify_items": null,
            "grid_row": null,
            "max_height": null,
            "align_content": null,
            "visibility": null,
            "align_self": null,
            "height": null,
            "min_height": null,
            "padding": null,
            "grid_auto_rows": null,
            "grid_gap": null,
            "max_width": null,
            "order": null,
            "_view_module_version": "1.2.0",
            "grid_template_areas": null,
            "object_position": null,
            "object_fit": null,
            "grid_auto_columns": null,
            "margin": null,
            "display": null,
            "left": null
          }
        },
        "a91b418b0e894206841cafd68c76635c": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "state": {
            "_view_name": "HBoxView",
            "_dom_classes": [],
            "_model_name": "HBoxModel",
            "_view_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_view_count": null,
            "_view_module_version": "1.5.0",
            "box_style": "",
            "layout": "IPY_MODEL_788c6f7099f8444785db00983185b0df",
            "_model_module": "@jupyter-widgets/controls",
            "children": [
              "IPY_MODEL_9392caa43a4c4842b1ee36fc2ae00751",
              "IPY_MODEL_1bd0533125e54322ae6557f0a3ffb9ee",
              "IPY_MODEL_1b42fd520cba4ddb9263be73db927a17"
            ]
          }
        },
        "788c6f7099f8444785db00983185b0df": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "state": {
            "_view_name": "LayoutView",
            "grid_template_rows": null,
            "right": null,
            "justify_content": null,
            "_view_module": "@jupyter-widgets/base",
            "overflow": null,
            "_model_module_version": "1.2.0",
            "_view_count": null,
            "flex_flow": null,
            "width": null,
            "min_width": null,
            "border": null,
            "align_items": null,
            "bottom": null,
            "_model_module": "@jupyter-widgets/base",
            "top": null,
            "grid_column": null,
            "overflow_y": null,
            "overflow_x": null,
            "grid_auto_flow": null,
            "grid_area": null,
            "grid_template_columns": null,
            "flex": null,
            "_model_name": "LayoutModel",
            "justify_items": null,
            "grid_row": null,
            "max_height": null,
            "align_content": null,
            "visibility": null,
            "align_self": null,
            "height": null,
            "min_height": null,
            "padding": null,
            "grid_auto_rows": null,
            "grid_gap": null,
            "max_width": null,
            "order": null,
            "_view_module_version": "1.2.0",
            "grid_template_areas": null,
            "object_position": null,
            "object_fit": null,
            "grid_auto_columns": null,
            "margin": null,
            "display": null,
            "left": null
          }
        },
        "9392caa43a4c4842b1ee36fc2ae00751": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "state": {
            "_view_name": "HTMLView",
            "style": "IPY_MODEL_e0bc13a423a24c7dab8d89b200493636",
            "_dom_classes": [],
            "description": "",
            "_model_name": "HTMLModel",
            "placeholder": "​",
            "_view_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "value": "100%",
            "_view_count": null,
            "_view_module_version": "1.5.0",
            "description_tooltip": null,
            "_model_module": "@jupyter-widgets/controls",
            "layout": "IPY_MODEL_4e029ce08999477088fd14376d37e4a9"
          }
        },
        "1bd0533125e54322ae6557f0a3ffb9ee": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "state": {
            "_view_name": "ProgressView",
            "style": "IPY_MODEL_bdf2d48c1386444c9d70fd6fedf57ba3",
            "_dom_classes": [],
            "description": "",
            "_model_name": "FloatProgressModel",
            "bar_style": "success",
            "max": 1,
            "_view_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "value": 1,
            "_view_count": null,
            "_view_module_version": "1.5.0",
            "orientation": "horizontal",
            "min": 0,
            "description_tooltip": null,
            "_model_module": "@jupyter-widgets/controls",
            "layout": "IPY_MODEL_5ccf2e8f6ca745c0a95bfd3d9646dad4"
          }
        },
        "1b42fd520cba4ddb9263be73db927a17": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "state": {
            "_view_name": "HTMLView",
            "style": "IPY_MODEL_ba5f6c7eb1fd4c66b642a4056766ec2d",
            "_dom_classes": [],
            "description": "",
            "_model_name": "HTMLModel",
            "placeholder": "​",
            "_view_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "value": " 1/1 [00:01&lt;00:00,  1.27s/it]",
            "_view_count": null,
            "_view_module_version": "1.5.0",
            "description_tooltip": null,
            "_model_module": "@jupyter-widgets/controls",
            "layout": "IPY_MODEL_00c49dd5296d4203bc5cb618593b7c1d"
          }
        },
        "e0bc13a423a24c7dab8d89b200493636": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "state": {
            "_view_name": "StyleView",
            "_model_name": "DescriptionStyleModel",
            "description_width": "",
            "_view_module": "@jupyter-widgets/base",
            "_model_module_version": "1.5.0",
            "_view_count": null,
            "_view_module_version": "1.2.0",
            "_model_module": "@jupyter-widgets/controls"
          }
        },
        "4e029ce08999477088fd14376d37e4a9": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "state": {
            "_view_name": "LayoutView",
            "grid_template_rows": null,
            "right": null,
            "justify_content": null,
            "_view_module": "@jupyter-widgets/base",
            "overflow": null,
            "_model_module_version": "1.2.0",
            "_view_count": null,
            "flex_flow": null,
            "width": null,
            "min_width": null,
            "border": null,
            "align_items": null,
            "bottom": null,
            "_model_module": "@jupyter-widgets/base",
            "top": null,
            "grid_column": null,
            "overflow_y": null,
            "overflow_x": null,
            "grid_auto_flow": null,
            "grid_area": null,
            "grid_template_columns": null,
            "flex": null,
            "_model_name": "LayoutModel",
            "justify_items": null,
            "grid_row": null,
            "max_height": null,
            "align_content": null,
            "visibility": null,
            "align_self": null,
            "height": null,
            "min_height": null,
            "padding": null,
            "grid_auto_rows": null,
            "grid_gap": null,
            "max_width": null,
            "order": null,
            "_view_module_version": "1.2.0",
            "grid_template_areas": null,
            "object_position": null,
            "object_fit": null,
            "grid_auto_columns": null,
            "margin": null,
            "display": null,
            "left": null
          }
        },
        "bdf2d48c1386444c9d70fd6fedf57ba3": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "state": {
            "_view_name": "StyleView",
            "_model_name": "ProgressStyleModel",
            "description_width": "",
            "_view_module": "@jupyter-widgets/base",
            "_model_module_version": "1.5.0",
            "_view_count": null,
            "_view_module_version": "1.2.0",
            "bar_color": null,
            "_model_module": "@jupyter-widgets/controls"
          }
        },
        "5ccf2e8f6ca745c0a95bfd3d9646dad4": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "state": {
            "_view_name": "LayoutView",
            "grid_template_rows": null,
            "right": null,
            "justify_content": null,
            "_view_module": "@jupyter-widgets/base",
            "overflow": null,
            "_model_module_version": "1.2.0",
            "_view_count": null,
            "flex_flow": null,
            "width": null,
            "min_width": null,
            "border": null,
            "align_items": null,
            "bottom": null,
            "_model_module": "@jupyter-widgets/base",
            "top": null,
            "grid_column": null,
            "overflow_y": null,
            "overflow_x": null,
            "grid_auto_flow": null,
            "grid_area": null,
            "grid_template_columns": null,
            "flex": null,
            "_model_name": "LayoutModel",
            "justify_items": null,
            "grid_row": null,
            "max_height": null,
            "align_content": null,
            "visibility": null,
            "align_self": null,
            "height": null,
            "min_height": null,
            "padding": null,
            "grid_auto_rows": null,
            "grid_gap": null,
            "max_width": null,
            "order": null,
            "_view_module_version": "1.2.0",
            "grid_template_areas": null,
            "object_position": null,
            "object_fit": null,
            "grid_auto_columns": null,
            "margin": null,
            "display": null,
            "left": null
          }
        },
        "ba5f6c7eb1fd4c66b642a4056766ec2d": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "state": {
            "_view_name": "StyleView",
            "_model_name": "DescriptionStyleModel",
            "description_width": "",
            "_view_module": "@jupyter-widgets/base",
            "_model_module_version": "1.5.0",
            "_view_count": null,
            "_view_module_version": "1.2.0",
            "_model_module": "@jupyter-widgets/controls"
          }
        },
        "00c49dd5296d4203bc5cb618593b7c1d": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "state": {
            "_view_name": "LayoutView",
            "grid_template_rows": null,
            "right": null,
            "justify_content": null,
            "_view_module": "@jupyter-widgets/base",
            "overflow": null,
            "_model_module_version": "1.2.0",
            "_view_count": null,
            "flex_flow": null,
            "width": null,
            "min_width": null,
            "border": null,
            "align_items": null,
            "bottom": null,
            "_model_module": "@jupyter-widgets/base",
            "top": null,
            "grid_column": null,
            "overflow_y": null,
            "overflow_x": null,
            "grid_auto_flow": null,
            "grid_area": null,
            "grid_template_columns": null,
            "flex": null,
            "_model_name": "LayoutModel",
            "justify_items": null,
            "grid_row": null,
            "max_height": null,
            "align_content": null,
            "visibility": null,
            "align_self": null,
            "height": null,
            "min_height": null,
            "padding": null,
            "grid_auto_rows": null,
            "grid_gap": null,
            "max_width": null,
            "order": null,
            "_view_module_version": "1.2.0",
            "grid_template_areas": null,
            "object_position": null,
            "object_fit": null,
            "grid_auto_columns": null,
            "margin": null,
            "display": null,
            "left": null
          }
        },
        "d87c77b2cbc0411497a0fc4d4fa6f4c7": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "state": {
            "_view_name": "HBoxView",
            "_dom_classes": [],
            "_model_name": "HBoxModel",
            "_view_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_view_count": null,
            "_view_module_version": "1.5.0",
            "box_style": "",
            "layout": "IPY_MODEL_e76825ffcd2b4c79b3b4a186f5b2acc3",
            "_model_module": "@jupyter-widgets/controls",
            "children": [
              "IPY_MODEL_f92b8eb045804966939a12564e3e0422",
              "IPY_MODEL_d607eba6cd83431ba84cfda5f9c4a7fc",
              "IPY_MODEL_a122d4de38ae459a99d5af04f960511f"
            ]
          }
        },
        "e76825ffcd2b4c79b3b4a186f5b2acc3": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "state": {
            "_view_name": "LayoutView",
            "grid_template_rows": null,
            "right": null,
            "justify_content": null,
            "_view_module": "@jupyter-widgets/base",
            "overflow": null,
            "_model_module_version": "1.2.0",
            "_view_count": null,
            "flex_flow": null,
            "width": null,
            "min_width": null,
            "border": null,
            "align_items": null,
            "bottom": null,
            "_model_module": "@jupyter-widgets/base",
            "top": null,
            "grid_column": null,
            "overflow_y": null,
            "overflow_x": null,
            "grid_auto_flow": null,
            "grid_area": null,
            "grid_template_columns": null,
            "flex": null,
            "_model_name": "LayoutModel",
            "justify_items": null,
            "grid_row": null,
            "max_height": null,
            "align_content": null,
            "visibility": null,
            "align_self": null,
            "height": null,
            "min_height": null,
            "padding": null,
            "grid_auto_rows": null,
            "grid_gap": null,
            "max_width": null,
            "order": null,
            "_view_module_version": "1.2.0",
            "grid_template_areas": null,
            "object_position": null,
            "object_fit": null,
            "grid_auto_columns": null,
            "margin": null,
            "display": null,
            "left": null
          }
        },
        "f92b8eb045804966939a12564e3e0422": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "state": {
            "_view_name": "HTMLView",
            "style": "IPY_MODEL_c9751caa858144b08333125c2ed56440",
            "_dom_classes": [],
            "description": "",
            "_model_name": "HTMLModel",
            "placeholder": "​",
            "_view_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "value": "100%",
            "_view_count": null,
            "_view_module_version": "1.5.0",
            "description_tooltip": null,
            "_model_module": "@jupyter-widgets/controls",
            "layout": "IPY_MODEL_01e0e2c9287841e4a38b71077ae02fb7"
          }
        },
        "d607eba6cd83431ba84cfda5f9c4a7fc": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "state": {
            "_view_name": "ProgressView",
            "style": "IPY_MODEL_2df24964a3fa4f96a74851b2a3cf6eb8",
            "_dom_classes": [],
            "description": "",
            "_model_name": "FloatProgressModel",
            "bar_style": "success",
            "max": 70662,
            "_view_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "value": 70662,
            "_view_count": null,
            "_view_module_version": "1.5.0",
            "orientation": "horizontal",
            "min": 0,
            "description_tooltip": null,
            "_model_module": "@jupyter-widgets/controls",
            "layout": "IPY_MODEL_9fe53ebf98c94acb9299e6b42e53dece"
          }
        },
        "a122d4de38ae459a99d5af04f960511f": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "state": {
            "_view_name": "HTMLView",
            "style": "IPY_MODEL_a907477fedf04269997b4c4828775ddc",
            "_dom_classes": [],
            "description": "",
            "_model_name": "HTMLModel",
            "placeholder": "​",
            "_view_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "value": " 70662/70662 [01:29&lt;00:00, 795.79it/s]",
            "_view_count": null,
            "_view_module_version": "1.5.0",
            "description_tooltip": null,
            "_model_module": "@jupyter-widgets/controls",
            "layout": "IPY_MODEL_75b8063e10ff4ebba6052d325b53ecab"
          }
        },
        "c9751caa858144b08333125c2ed56440": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "state": {
            "_view_name": "StyleView",
            "_model_name": "DescriptionStyleModel",
            "description_width": "",
            "_view_module": "@jupyter-widgets/base",
            "_model_module_version": "1.5.0",
            "_view_count": null,
            "_view_module_version": "1.2.0",
            "_model_module": "@jupyter-widgets/controls"
          }
        },
        "01e0e2c9287841e4a38b71077ae02fb7": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "state": {
            "_view_name": "LayoutView",
            "grid_template_rows": null,
            "right": null,
            "justify_content": null,
            "_view_module": "@jupyter-widgets/base",
            "overflow": null,
            "_model_module_version": "1.2.0",
            "_view_count": null,
            "flex_flow": null,
            "width": null,
            "min_width": null,
            "border": null,
            "align_items": null,
            "bottom": null,
            "_model_module": "@jupyter-widgets/base",
            "top": null,
            "grid_column": null,
            "overflow_y": null,
            "overflow_x": null,
            "grid_auto_flow": null,
            "grid_area": null,
            "grid_template_columns": null,
            "flex": null,
            "_model_name": "LayoutModel",
            "justify_items": null,
            "grid_row": null,
            "max_height": null,
            "align_content": null,
            "visibility": null,
            "align_self": null,
            "height": null,
            "min_height": null,
            "padding": null,
            "grid_auto_rows": null,
            "grid_gap": null,
            "max_width": null,
            "order": null,
            "_view_module_version": "1.2.0",
            "grid_template_areas": null,
            "object_position": null,
            "object_fit": null,
            "grid_auto_columns": null,
            "margin": null,
            "display": null,
            "left": null
          }
        },
        "2df24964a3fa4f96a74851b2a3cf6eb8": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "state": {
            "_view_name": "StyleView",
            "_model_name": "ProgressStyleModel",
            "description_width": "",
            "_view_module": "@jupyter-widgets/base",
            "_model_module_version": "1.5.0",
            "_view_count": null,
            "_view_module_version": "1.2.0",
            "bar_color": null,
            "_model_module": "@jupyter-widgets/controls"
          }
        },
        "9fe53ebf98c94acb9299e6b42e53dece": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "state": {
            "_view_name": "LayoutView",
            "grid_template_rows": null,
            "right": null,
            "justify_content": null,
            "_view_module": "@jupyter-widgets/base",
            "overflow": null,
            "_model_module_version": "1.2.0",
            "_view_count": null,
            "flex_flow": null,
            "width": null,
            "min_width": null,
            "border": null,
            "align_items": null,
            "bottom": null,
            "_model_module": "@jupyter-widgets/base",
            "top": null,
            "grid_column": null,
            "overflow_y": null,
            "overflow_x": null,
            "grid_auto_flow": null,
            "grid_area": null,
            "grid_template_columns": null,
            "flex": null,
            "_model_name": "LayoutModel",
            "justify_items": null,
            "grid_row": null,
            "max_height": null,
            "align_content": null,
            "visibility": null,
            "align_self": null,
            "height": null,
            "min_height": null,
            "padding": null,
            "grid_auto_rows": null,
            "grid_gap": null,
            "max_width": null,
            "order": null,
            "_view_module_version": "1.2.0",
            "grid_template_areas": null,
            "object_position": null,
            "object_fit": null,
            "grid_auto_columns": null,
            "margin": null,
            "display": null,
            "left": null
          }
        },
        "a907477fedf04269997b4c4828775ddc": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "state": {
            "_view_name": "StyleView",
            "_model_name": "DescriptionStyleModel",
            "description_width": "",
            "_view_module": "@jupyter-widgets/base",
            "_model_module_version": "1.5.0",
            "_view_count": null,
            "_view_module_version": "1.2.0",
            "_model_module": "@jupyter-widgets/controls"
          }
        },
        "75b8063e10ff4ebba6052d325b53ecab": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "state": {
            "_view_name": "LayoutView",
            "grid_template_rows": null,
            "right": null,
            "justify_content": null,
            "_view_module": "@jupyter-widgets/base",
            "overflow": null,
            "_model_module_version": "1.2.0",
            "_view_count": null,
            "flex_flow": null,
            "width": null,
            "min_width": null,
            "border": null,
            "align_items": null,
            "bottom": null,
            "_model_module": "@jupyter-widgets/base",
            "top": null,
            "grid_column": null,
            "overflow_y": null,
            "overflow_x": null,
            "grid_auto_flow": null,
            "grid_area": null,
            "grid_template_columns": null,
            "flex": null,
            "_model_name": "LayoutModel",
            "justify_items": null,
            "grid_row": null,
            "max_height": null,
            "align_content": null,
            "visibility": null,
            "align_self": null,
            "height": null,
            "min_height": null,
            "padding": null,
            "grid_auto_rows": null,
            "grid_gap": null,
            "max_width": null,
            "order": null,
            "_view_module_version": "1.2.0",
            "grid_template_areas": null,
            "object_position": null,
            "object_fit": null,
            "grid_auto_columns": null,
            "margin": null,
            "display": null,
            "left": null
          }
        },
        "e9d7c5aed3704ad383dbff12fea51307": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "state": {
            "_view_name": "HBoxView",
            "_dom_classes": [],
            "_model_name": "HBoxModel",
            "_view_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_view_count": null,
            "_view_module_version": "1.5.0",
            "box_style": "",
            "layout": "IPY_MODEL_4f3996f881974ba6a3ec9d6abba22941",
            "_model_module": "@jupyter-widgets/controls",
            "children": [
              "IPY_MODEL_ce673c5aa2ed4c3b9e43b72738833dde",
              "IPY_MODEL_18236481cf85448fb7ef14803a9090b9",
              "IPY_MODEL_871401a05b9c4854b7ddfefb70b359f2"
            ]
          }
        },
        "4f3996f881974ba6a3ec9d6abba22941": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "state": {
            "_view_name": "LayoutView",
            "grid_template_rows": null,
            "right": null,
            "justify_content": null,
            "_view_module": "@jupyter-widgets/base",
            "overflow": null,
            "_model_module_version": "1.2.0",
            "_view_count": null,
            "flex_flow": null,
            "width": null,
            "min_width": null,
            "border": null,
            "align_items": null,
            "bottom": null,
            "_model_module": "@jupyter-widgets/base",
            "top": null,
            "grid_column": null,
            "overflow_y": null,
            "overflow_x": null,
            "grid_auto_flow": null,
            "grid_area": null,
            "grid_template_columns": null,
            "flex": null,
            "_model_name": "LayoutModel",
            "justify_items": null,
            "grid_row": null,
            "max_height": null,
            "align_content": null,
            "visibility": null,
            "align_self": null,
            "height": null,
            "min_height": null,
            "padding": null,
            "grid_auto_rows": null,
            "grid_gap": null,
            "max_width": null,
            "order": null,
            "_view_module_version": "1.2.0",
            "grid_template_areas": null,
            "object_position": null,
            "object_fit": null,
            "grid_auto_columns": null,
            "margin": null,
            "display": null,
            "left": null
          }
        },
        "ce673c5aa2ed4c3b9e43b72738833dde": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "state": {
            "_view_name": "HTMLView",
            "style": "IPY_MODEL_6686209091af489583a132973cf86048",
            "_dom_classes": [],
            "description": "",
            "_model_name": "HTMLModel",
            "placeholder": "​",
            "_view_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "value": "100%",
            "_view_count": null,
            "_view_module_version": "1.5.0",
            "description_tooltip": null,
            "_model_module": "@jupyter-widgets/controls",
            "layout": "IPY_MODEL_b7dd2d9318a74c6da16f7faf5536e7c3"
          }
        },
        "18236481cf85448fb7ef14803a9090b9": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "state": {
            "_view_name": "ProgressView",
            "style": "IPY_MODEL_6e37be5dd8ec432d8a74e8b6b21dfccb",
            "_dom_classes": [],
            "description": "",
            "_model_name": "FloatProgressModel",
            "bar_style": "success",
            "max": 1,
            "_view_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "value": 1,
            "_view_count": null,
            "_view_module_version": "1.5.0",
            "orientation": "horizontal",
            "min": 0,
            "description_tooltip": null,
            "_model_module": "@jupyter-widgets/controls",
            "layout": "IPY_MODEL_94689ac2ca7f4110bf33e5fd3fe4d22e"
          }
        },
        "871401a05b9c4854b7ddfefb70b359f2": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "state": {
            "_view_name": "HTMLView",
            "style": "IPY_MODEL_510714ae65bc49a1a8f8029ea2376d26",
            "_dom_classes": [],
            "description": "",
            "_model_name": "HTMLModel",
            "placeholder": "​",
            "_view_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "value": " 1/1 [00:14&lt;00:00, 14.79s/it]",
            "_view_count": null,
            "_view_module_version": "1.5.0",
            "description_tooltip": null,
            "_model_module": "@jupyter-widgets/controls",
            "layout": "IPY_MODEL_16e9d535efd84dcf96253adfe53f6c14"
          }
        },
        "6686209091af489583a132973cf86048": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "state": {
            "_view_name": "StyleView",
            "_model_name": "DescriptionStyleModel",
            "description_width": "",
            "_view_module": "@jupyter-widgets/base",
            "_model_module_version": "1.5.0",
            "_view_count": null,
            "_view_module_version": "1.2.0",
            "_model_module": "@jupyter-widgets/controls"
          }
        },
        "b7dd2d9318a74c6da16f7faf5536e7c3": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "state": {
            "_view_name": "LayoutView",
            "grid_template_rows": null,
            "right": null,
            "justify_content": null,
            "_view_module": "@jupyter-widgets/base",
            "overflow": null,
            "_model_module_version": "1.2.0",
            "_view_count": null,
            "flex_flow": null,
            "width": null,
            "min_width": null,
            "border": null,
            "align_items": null,
            "bottom": null,
            "_model_module": "@jupyter-widgets/base",
            "top": null,
            "grid_column": null,
            "overflow_y": null,
            "overflow_x": null,
            "grid_auto_flow": null,
            "grid_area": null,
            "grid_template_columns": null,
            "flex": null,
            "_model_name": "LayoutModel",
            "justify_items": null,
            "grid_row": null,
            "max_height": null,
            "align_content": null,
            "visibility": null,
            "align_self": null,
            "height": null,
            "min_height": null,
            "padding": null,
            "grid_auto_rows": null,
            "grid_gap": null,
            "max_width": null,
            "order": null,
            "_view_module_version": "1.2.0",
            "grid_template_areas": null,
            "object_position": null,
            "object_fit": null,
            "grid_auto_columns": null,
            "margin": null,
            "display": null,
            "left": null
          }
        },
        "6e37be5dd8ec432d8a74e8b6b21dfccb": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "state": {
            "_view_name": "StyleView",
            "_model_name": "ProgressStyleModel",
            "description_width": "",
            "_view_module": "@jupyter-widgets/base",
            "_model_module_version": "1.5.0",
            "_view_count": null,
            "_view_module_version": "1.2.0",
            "bar_color": null,
            "_model_module": "@jupyter-widgets/controls"
          }
        },
        "94689ac2ca7f4110bf33e5fd3fe4d22e": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "state": {
            "_view_name": "LayoutView",
            "grid_template_rows": null,
            "right": null,
            "justify_content": null,
            "_view_module": "@jupyter-widgets/base",
            "overflow": null,
            "_model_module_version": "1.2.0",
            "_view_count": null,
            "flex_flow": null,
            "width": null,
            "min_width": null,
            "border": null,
            "align_items": null,
            "bottom": null,
            "_model_module": "@jupyter-widgets/base",
            "top": null,
            "grid_column": null,
            "overflow_y": null,
            "overflow_x": null,
            "grid_auto_flow": null,
            "grid_area": null,
            "grid_template_columns": null,
            "flex": null,
            "_model_name": "LayoutModel",
            "justify_items": null,
            "grid_row": null,
            "max_height": null,
            "align_content": null,
            "visibility": null,
            "align_self": null,
            "height": null,
            "min_height": null,
            "padding": null,
            "grid_auto_rows": null,
            "grid_gap": null,
            "max_width": null,
            "order": null,
            "_view_module_version": "1.2.0",
            "grid_template_areas": null,
            "object_position": null,
            "object_fit": null,
            "grid_auto_columns": null,
            "margin": null,
            "display": null,
            "left": null
          }
        },
        "510714ae65bc49a1a8f8029ea2376d26": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "state": {
            "_view_name": "StyleView",
            "_model_name": "DescriptionStyleModel",
            "description_width": "",
            "_view_module": "@jupyter-widgets/base",
            "_model_module_version": "1.5.0",
            "_view_count": null,
            "_view_module_version": "1.2.0",
            "_model_module": "@jupyter-widgets/controls"
          }
        },
        "16e9d535efd84dcf96253adfe53f6c14": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "state": {
            "_view_name": "LayoutView",
            "grid_template_rows": null,
            "right": null,
            "justify_content": null,
            "_view_module": "@jupyter-widgets/base",
            "overflow": null,
            "_model_module_version": "1.2.0",
            "_view_count": null,
            "flex_flow": null,
            "width": null,
            "min_width": null,
            "border": null,
            "align_items": null,
            "bottom": null,
            "_model_module": "@jupyter-widgets/base",
            "top": null,
            "grid_column": null,
            "overflow_y": null,
            "overflow_x": null,
            "grid_auto_flow": null,
            "grid_area": null,
            "grid_template_columns": null,
            "flex": null,
            "_model_name": "LayoutModel",
            "justify_items": null,
            "grid_row": null,
            "max_height": null,
            "align_content": null,
            "visibility": null,
            "align_self": null,
            "height": null,
            "min_height": null,
            "padding": null,
            "grid_auto_rows": null,
            "grid_gap": null,
            "max_width": null,
            "order": null,
            "_view_module_version": "1.2.0",
            "grid_template_areas": null,
            "object_position": null,
            "object_fit": null,
            "grid_auto_columns": null,
            "margin": null,
            "display": null,
            "left": null
          }
        }
      }
    }
  },
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "FR5qANU23d0K"
      },
      "source": [
        "# Booking.com Challenge - WebTour 2021 <br> ACM WSDM workshop\n",
        "4th place solution for [Booking.com](https://www.bookingchallenge.com/final-leaderboard-results)'s next destination\n",
        "recommendation challenge.\n",
        "\n",
        "[Documentation](https://mbaigorria.github.io/booking-challenge-2021-recsys) |\n",
        "[Github](https://github.com/mbaigorria/booking-challenge-2021-recsys) |\n",
        "[Colab](https://colab.research.google.com/drive/1202KKmzrIZY0t9dhOoA5zINPI0qkx4lX)\n",
        "\n",
        "#### Recommended Citation:\n",
        "\n",
        "```\n",
        "@inproceedings{DOI_CODE,\n",
        " author = {Baigorria Alonso, Martín},\n",
        " booktitle = {ACM WSDM Workshop on Web Tourism (WSDM WebTour’21)},\n",
        " howpublished = {\\url{https://mbaigorria.github.io/booking-challenge-2021-recsys}},\n",
        " title = {Many-To-Many RNN Model For Session-Aware Recommender Systems},\n",
        " year = {2021}\n",
        "}\n",
        "```"
      ]
    },
    {
      "cell_type": "code",
      "metadata": {
        "id": "j4nw6cuI3r3r"
      },
      "source": [
        "!git clone git@github.com:mbaigorria/booking-challenge-2021-recsys.git"
      ],
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "8_80nElb4N6k",
        "outputId": "ce9ac22f-b039-41e1-89bd-5509cc968a7c"
      },
      "source": [
        "%cd booking-challenge-2021-recsys/\n",
        "!bash get_resources.sh\n",
        "!pip install -e ."
      ],
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "text": [
            "/content/booking-challenge-2021-recsys\n",
            "--2021-02-20 14:56:36--  https://shoutout.wix.com/so/c4NRCVgeV/c?w=OUERqDAyWlD4w8xMugq00JMzsLO6ZoB9fQcWfVv409k.eyJ1IjoiaHR0cHM6Ly8wMzUxMDVmNy1hZTMyLTQ3YjYtYTI1Yi04N2FmNzkyNGM3ZWEudXNyZmlsZXMuY29tL2FyY2hpdmVzLzMwOTFiZV84Mzc4NGYzMzA1NWM0NzkxYWUyYjY4ODdlMTFkZGYwOS56aXA_ZG49QktOR3Rlc3RkYXRhV1NETTIwMjEuemlwIiwiciI6IjAzMzQzYjU3LTQ5MGYtNDk3OS02NGFjLTZjZTJlYjBiZDU0NyIsIm0iOiJtYWlsIiwiYyI6IjRlNjU2ZjFhLTEzOTgtNDRiNy04OWJiLTRhNjc5Mjc1MGExYSJ9\n",
            "Resolving shoutout.wix.com (shoutout.wix.com)... 185.230.61.101\n",
            "Connecting to shoutout.wix.com (shoutout.wix.com)|185.230.61.101|:443... connected.\n",
            "HTTP request sent, awaiting response... 302 Found\n",
            "Location: https://035105f7-ae32-47b6-a25b-87af7924c7ea.usrfiles.com/archives/3091be_83784f33055c4791ae2b6887e11ddf09.zip?dn=BKNGtestdataWSDM2021.zip [following]\n",
            "--2021-02-20 14:56:37--  https://035105f7-ae32-47b6-a25b-87af7924c7ea.usrfiles.com/archives/3091be_83784f33055c4791ae2b6887e11ddf09.zip?dn=BKNGtestdataWSDM2021.zip\n",
            "Resolving 035105f7-ae32-47b6-a25b-87af7924c7ea.usrfiles.com (035105f7-ae32-47b6-a25b-87af7924c7ea.usrfiles.com)... 34.102.176.152\n",
            "Connecting to 035105f7-ae32-47b6-a25b-87af7924c7ea.usrfiles.com (035105f7-ae32-47b6-a25b-87af7924c7ea.usrfiles.com)|34.102.176.152|:443... connected.\n",
            "HTTP request sent, awaiting response... 200 OK\n",
            "Length: 21931123 (21M) [application/zip]\n",
            "Saving to: ‘dataset.zip’\n",
            "\n",
            "dataset.zip         100%[===================>]  20.92M  16.4MB/s    in 1.3s    \n",
            "\n",
            "2021-02-20 14:56:38 (16.4 MB/s) - ‘dataset.zip’ saved [21931123/21931123]\n",
            "\n",
            "Archive:  dataset.zip\n",
            "  inflating: resources/booking_test_set.csv  \n",
            "  inflating: resources/booking_train_set.csv  \n",
            "  inflating: resources/__MACOSX/._booking_train_set.csv  \n",
            "  inflating: resources/evaluation_sample.ipynb  \n",
            "  inflating: resources/Readme.md     \n",
            "  inflating: resources/__MACOSX/._Readme.md  \n",
            "  inflating: resources/sample_test_set.csv  \n",
            "  inflating: resources/__MACOSX/._sample_test_set.csv  \n",
            "  inflating: resources/sample_truth.csv  \n",
            "  inflating: resources/__MACOSX/._sample_truth.csv  \n",
            "  inflating: resources/submission.csv  \n",
            "  inflating: resources/__MACOSX/._submission.csv  \n",
            "Obtaining file:///content/booking-challenge-2021-recsys\n",
            "Requirement already satisfied: pandas>=1.1.5 in /usr/local/lib/python3.6/dist-packages (from Booking.com-Sequence-Aware-Recommender-System==1.0) (1.1.5)\n",
            "Requirement already satisfied: numpy>=1.16.2 in /usr/local/lib/python3.6/dist-packages (from Booking.com-Sequence-Aware-Recommender-System==1.0) (1.19.5)\n",
            "Requirement already satisfied: sklearn in /usr/local/lib/python3.6/dist-packages (from Booking.com-Sequence-Aware-Recommender-System==1.0) (0.0)\n",
            "Requirement already satisfied: torch in /usr/local/lib/python3.6/dist-packages (from Booking.com-Sequence-Aware-Recommender-System==1.0) (1.7.0+cu101)\n",
            "Collecting tqdm>=4.56.0\n",
            "\u001b[?25l  Downloading https://files.pythonhosted.org/packages/d9/13/f3f815bb73804a8af9cfbb6f084821c037109108885f46131045e8cf044e/tqdm-4.57.0-py2.py3-none-any.whl (72kB)\n",
            "\u001b[K     |████████████████████████████████| 81kB 6.9MB/s \n",
            "\u001b[?25hCollecting GPUtil>=1.4.0\n",
            "  Downloading https://files.pythonhosted.org/packages/ed/0e/5c61eedde9f6c87713e89d794f01e378cfd9565847d4576fa627d758c554/GPUtil-1.4.0.tar.gz\n",
            "Collecting psutil>=5.8.0\n",
            "\u001b[?25l  Downloading https://files.pythonhosted.org/packages/da/82/56cd16a4c5f53e3e5dd7b2c30d5c803e124f218ebb644ca9c30bc907eadd/psutil-5.8.0-cp36-cp36m-manylinux2010_x86_64.whl (291kB)\n",
            "\u001b[K     |████████████████████████████████| 296kB 20.4MB/s \n",
            "\u001b[?25hCollecting humanize>=3.2.0\n",
            "\u001b[?25l  Downloading https://files.pythonhosted.org/packages/49/ac/7673fc4c19f0ecd258c3a9636d63cb77003c2c6afc46943d3db752b35758/humanize-3.2.0-py3-none-any.whl (70kB)\n",
            "\u001b[K     |████████████████████████████████| 71kB 6.9MB/s \n",
            "\u001b[?25hRequirement already satisfied: matplotlib>=3.1.3 in /usr/local/lib/python3.6/dist-packages (from Booking.com-Sequence-Aware-Recommender-System==1.0) (3.2.2)\n",
            "Collecting memoized_property>=1.0.3\n",
            "  Downloading https://files.pythonhosted.org/packages/70/db/23f8b5d86c9385299586c2469b58087f658f58eaeb414be0fd64cfd054e1/memoized-property-1.0.3.tar.gz\n",
            "Requirement already satisfied: seaborn>=0.11.1 in /usr/local/lib/python3.6/dist-packages (from Booking.com-Sequence-Aware-Recommender-System==1.0) (0.11.1)\n",
            "Requirement already satisfied: python-dateutil>=2.7.3 in /usr/local/lib/python3.6/dist-packages (from pandas>=1.1.5->Booking.com-Sequence-Aware-Recommender-System==1.0) (2.8.1)\n",
            "Requirement already satisfied: pytz>=2017.2 in /usr/local/lib/python3.6/dist-packages (from pandas>=1.1.5->Booking.com-Sequence-Aware-Recommender-System==1.0) (2018.9)\n",
            "Requirement already satisfied: scikit-learn in /usr/local/lib/python3.6/dist-packages (from sklearn->Booking.com-Sequence-Aware-Recommender-System==1.0) (0.22.2.post1)\n",
            "Requirement already satisfied: future in /usr/local/lib/python3.6/dist-packages (from torch->Booking.com-Sequence-Aware-Recommender-System==1.0) (0.16.0)\n",
            "Requirement already satisfied: typing-extensions in /usr/local/lib/python3.6/dist-packages (from torch->Booking.com-Sequence-Aware-Recommender-System==1.0) (3.7.4.3)\n",
            "Requirement already satisfied: dataclasses in /usr/local/lib/python3.6/dist-packages (from torch->Booking.com-Sequence-Aware-Recommender-System==1.0) (0.8)\n",
            "Requirement already satisfied: setuptools in /usr/local/lib/python3.6/dist-packages (from humanize>=3.2.0->Booking.com-Sequence-Aware-Recommender-System==1.0) (53.0.0)\n",
            "Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.6/dist-packages (from matplotlib>=3.1.3->Booking.com-Sequence-Aware-Recommender-System==1.0) (1.3.1)\n",
            "Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.1 in /usr/local/lib/python3.6/dist-packages (from matplotlib>=3.1.3->Booking.com-Sequence-Aware-Recommender-System==1.0) (2.4.7)\n",
            "Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.6/dist-packages (from matplotlib>=3.1.3->Booking.com-Sequence-Aware-Recommender-System==1.0) (0.10.0)\n",
            "Requirement already satisfied: scipy>=1.0 in /usr/local/lib/python3.6/dist-packages (from seaborn>=0.11.1->Booking.com-Sequence-Aware-Recommender-System==1.0) (1.4.1)\n",
            "Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.6/dist-packages (from python-dateutil>=2.7.3->pandas>=1.1.5->Booking.com-Sequence-Aware-Recommender-System==1.0) (1.15.0)\n",
            "Requirement already satisfied: joblib>=0.11 in /usr/local/lib/python3.6/dist-packages (from scikit-learn->sklearn->Booking.com-Sequence-Aware-Recommender-System==1.0) (1.0.0)\n",
            "Building wheels for collected packages: GPUtil, memoized-property\n",
            "  Building wheel for GPUtil (setup.py) ... \u001b[?25l\u001b[?25hdone\n",
            "  Created wheel for GPUtil: filename=GPUtil-1.4.0-cp36-none-any.whl size=7411 sha256=ae02f5deb218c150ef72e8322ce3d9739b25218c5db1aea0a6d55be374a8a68f\n",
            "  Stored in directory: /root/.cache/pip/wheels/3d/77/07/80562de4bb0786e5ea186911a2c831fdd0018bda69beab71fd\n",
            "  Building wheel for memoized-property (setup.py) ... \u001b[?25l\u001b[?25hdone\n",
            "  Created wheel for memoized-property: filename=memoized_property-1.0.3-py2.py3-none-any.whl size=4175 sha256=f8b9242f33501b11acabc72fd8c8e4f95ebb9ea8a48fe6de02b7361ae3a9f629\n",
            "  Stored in directory: /root/.cache/pip/wheels/8e/d4/82/ace27b33257f5918497d20427c0ac31d39c76e68b44d593fe6\n",
            "Successfully built GPUtil memoized-property\n",
            "Installing collected packages: tqdm, GPUtil, psutil, humanize, memoized-property, Booking.com-Sequence-Aware-Recommender-System\n",
            "  Found existing installation: tqdm 4.41.1\n",
            "    Uninstalling tqdm-4.41.1:\n",
            "      Successfully uninstalled tqdm-4.41.1\n",
            "  Found existing installation: psutil 5.4.8\n",
            "    Uninstalling psutil-5.4.8:\n",
            "      Successfully uninstalled psutil-5.4.8\n",
            "  Found existing installation: humanize 0.5.1\n",
            "    Uninstalling humanize-0.5.1:\n",
            "      Successfully uninstalled humanize-0.5.1\n",
            "  Running setup.py develop for Booking.com-Sequence-Aware-Recommender-System\n",
            "Successfully installed Booking.com-Sequence-Aware-Recommender-System GPUtil-1.4.0 humanize-3.2.0 memoized-property-1.0.3 psutil-5.8.0 tqdm-4.57.0\n"
          ],
          "name": "stdout"
        }
      ]
    },
    {
      "cell_type": "code",
      "metadata": {
        "id": "zZAJJyq24K_J"
      },
      "source": [
        "%load_ext autoreload\n",
        "%autoreload 2"
      ],
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "Vc84LXel36lW",
        "outputId": "66aebc2e-52b1-4b48-e6d1-c1d6653e0c36"
      },
      "source": [
        "import logging\n",
        "\n",
        "from recsys import config\n",
        "from recsys.dataset import build_dataset, get_training_set_from_dataset, \\\n",
        "    get_test_set_from_dataset, set_future_features, get_submission_set_from_dataset\n",
        "from recsys.dataset_loader import get_dataset_and_dataloader, batches_to_device\n",
        "from recsys.encoders import DatasetEncoder\n",
        "from recsys.experiments import get_base_configuration, \\\n",
        "    get_model_performance_data, filter_results_table\n",
        "from recsys.model_train import train_model_for_folds\n",
        "from recsys.paths import get_path\n",
        "from recsys.plot import get_plot_from_accuracy\n",
        "from recsys.utils import get_distribution_by_pos, print_gpu_usage, get_final_submission"
      ],
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "text": [
            "INFO:root:Using GPU 0: Tesla V100-SXM2-16GB (UUID: GPU-d1b260b2-0a63-8081-d5d4-fbc86a7a898c)\n"
          ],
          "name": "stderr"
        }
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "M32TwLUV88r0"
      },
      "source": [
        "# Build and encode dataset"
      ]
    },
    {
      "cell_type": "code",
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "7q3Rk6Bx7YPn",
        "outputId": "21e54208-0d01-4806-edfc-4a64ed5aa1e1"
      },
      "source": [
        "dataset = build_dataset(reserved_obs=30000)\n",
        "de = DatasetEncoder(config.FEATURES_TO_ENCODE)\n",
        "de.fit_transform(dataset)\n",
        "set_future_features(dataset)\n",
        "\n",
        "submission_set = get_submission_set_from_dataset(dataset)\n",
        "\n",
        "# keep only observations before the last visit\n",
        "dataset = dataset[~dataset.next_city_id.isna()]\n",
        "\n",
        "# split training and test set from dataset\n",
        "train_set = get_training_set_from_dataset(dataset)\n",
        "test_set = get_test_set_from_dataset(dataset)\n",
        "\n",
        "logging.info(f\"Training set: {train_set.shape}\")\n",
        "logging.info(f\"Test set: {test_set.shape}\")\n",
        "logging.info(f\"Dataset: {dataset.shape}\")\n",
        "\n",
        "logging.info(get_distribution_by_pos(dataset=dataset,\n",
        "                                      train_set=train_set[train_set.train == 1],\n",
        "                                      test_set=test_set,\n",
        "                                      submission=submission_set).head(10))"
      ],
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "text": [
            "/usr/local/lib/python3.6/dist-packages/numpy/lib/arraysetops.py:580: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison\n",
            "  mask |= (ar1 == a)\n",
            "INFO:numexpr.utils:NumExpr defaulting to 4 threads.\n",
            "INFO:root:Running LabelEncoder on columns\n",
            "INFO:root:city_id: 39901\n",
            "INFO:root:device_class: 3\n",
            "INFO:root:affiliate_id: 3611\n",
            "INFO:root:booker_country: 5\n",
            "INFO:root:hotel_country: 195\n",
            "INFO:root:checkin_year: 3\n",
            "INFO:root:days_stay: 30\n",
            "INFO:root:checkin_day: 7\n",
            "INFO:root:checkin_month: 12\n",
            "INFO:root:transition_days: 32\n",
            "INFO:root:Training set: (1162101, 21)\n",
            "INFO:root:Test set: (24354, 21)\n",
            "INFO:root:Dataset: (1186492, 21)\n",
            "INFO:root:     dataset  train_set  test_set  submission\n",
            "1   0.000604   0.000816       NaN         NaN\n",
            "2   0.113137   0.002713       NaN         NaN\n",
            "3   0.397957   0.452025  0.454903    0.453101\n",
            "4   0.203990   0.229277  0.224588    0.231369\n",
            "5   0.113595   0.125860  0.128848    0.126560\n",
            "6   0.066251   0.073781  0.082677    0.075628\n",
            "7   0.039541   0.043639  0.042233    0.042385\n",
            "8   0.023987   0.026599  0.024338    0.027044\n",
            "9   0.014922   0.016427  0.016285    0.016133\n",
            "10  0.009406   0.010313  0.008948    0.010303\n"
          ],
          "name": "stderr"
        }
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "nShAtmLc9F8s"
      },
      "source": [
        "# Pre-load all batches to GPU"
      ]
    },
    {
      "cell_type": "code",
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 83,
          "referenced_widgets": [
            "14a6ef44c70d4cb98281b68210c0b3c7",
            "6d5d85fe7e0346609dfb32dbab8f5a94",
            "06a9838bca3a4ef59a44c4c1484e67ed",
            "e6f6e425d87a4bd5868dcdd929ed64e3",
            "44a5f22451014029ba0e7b9b38a007b1",
            "571c0be7334c4318bf8f3b0219eb0b5e",
            "68f45a493cc449a591dbe637c87e5e07",
            "dfa954117de64aa28609d63fa973b157",
            "75cf9b62514d4147858187194aa820f2",
            "0f807a7f15bc47b48fe761386f808812",
            "39c738da42274e3fb9bb975fcec1d1bc"
          ]
        },
        "id": "4w5tD0bi78-6",
        "outputId": "c2bcc721-f92c-4d30-c7a1-dac691f5e0c9"
      },
      "source": [
        "_, dataset_loader = get_dataset_and_dataloader(\n",
        "    train_set,\n",
        "    features=config.FEATURES_EMBEDDING + ['next_city_id'],\n",
        "    batch_size=config.BATCH_SIZE\n",
        ")\n",
        "dataset_batches_cuda = batches_to_device(dataset_loader)\n",
        "\n",
        "print_gpu_usage(0)"
      ],
      "execution_count": null,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "application/vnd.jupyter.widget-view+json": {
              "model_id": "14a6ef44c70d4cb98281b68210c0b3c7",
              "version_minor": 0,
              "version_major": 2
            },
            "text/plain": [
              "  0%|          | 0/282628 [00:00<?, ?it/s]"
            ]
          },
          "metadata": {
            "tags": []
          }
        },
        {
          "output_type": "stream",
          "text": [
            "INFO:root:Gen RAM Free: 20.5 GB | Proc size: 7.8 GB\n",
            "INFO:root:GPU RAM Free: 14801MB | Used: 1359MB | Util   8% | Total 16160MB\n"
          ],
          "name": "stderr"
        }
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "kUgG00fG9QuG"
      },
      "source": [
        "# Train model"
      ]
    },
    {
      "cell_type": "code",
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 933,
          "referenced_widgets": [
            "2a5f7cf508214ef8bac7bde4805da3a4",
            "c41042eec09147c6a45da7f018881e38",
            "e8b466f87e6849e0a2460750629f51e3",
            "044b0b8a2e1b48629f9a576426bdbf0e",
            "288dded8872641dfbf1778871931a0b1",
            "877a516afd0d4e38ab4b0eb7b3b38531",
            "f1e85767b60541ec88ebf5150b6765c3",
            "52296aad7771447e9b8006f1a583aa3f",
            "732a2844209b48828168dd643c97a135",
            "589be6fd7fff4831bd19530f0caed3a9",
            "d6eacede507341b38177b205bdb32846"
          ]
        },
        "id": "e3EC0min9KXy",
        "outputId": "987a888c-9380-438e-efbb-b56c547f5f5e"
      },
      "source": [
        "# train model from best configuration\n",
        "model_configuration = get_base_configuration()\n",
        "model_hash = train_model_for_folds(dataset_batches_cuda,\n",
        "                                    train_set,\n",
        "                                    model_configuration,\n",
        "                                    n_models=1)"
      ],
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "text": [
            "INFO:root:Weights: 1\n",
            "INFO:root:Training model 0962b86e for fold 0\n"
          ],
          "name": "stderr"
        },
        {
          "output_type": "display_data",
          "data": {
            "application/vnd.jupyter.widget-view+json": {
              "model_id": "2a5f7cf508214ef8bac7bde4805da3a4",
              "version_minor": 0,
              "version_major": 2
            },
            "text/plain": [
              "  0%|          | 0/50 [00:00<?, ?it/s]"
            ]
          },
          "metadata": {
            "tags": []
          }
        },
        {
          "output_type": "stream",
          "text": [
            "INFO:root:Epoch: 0, train loss: 7.7697, valid loss: 5.9697, accuracy@1: 0.1885, accuracy@4: 0.3736, time: 0:00:11\n",
            "INFO:root:Epoch: 1, train loss: 6.0877, valid loss: 5.3107, accuracy@1: 0.2133, accuracy@4: 0.4121, time: 0:00:10\n",
            "INFO:root:Epoch: 2, train loss: 5.5727, valid loss: 4.9853, accuracy@1: 0.2294, accuracy@4: 0.4325, time: 0:00:10\n",
            "INFO:root:Epoch: 3, train loss: 5.2689, valid loss: 4.7851, accuracy@1: 0.2379, accuracy@4: 0.4464, time: 0:00:10\n",
            "INFO:root:Epoch: 4, train loss: 5.0568, valid loss: 4.6372, accuracy@1: 0.2451, accuracy@4: 0.4564, time: 0:00:10\n",
            "INFO:root:Epoch: 5, train loss: 4.8936, valid loss: 4.5318, accuracy@1: 0.2507, accuracy@4: 0.4641, time: 0:00:10\n",
            "INFO:root:Epoch: 6, train loss: 4.7635, valid loss: 4.4464, accuracy@1: 0.2605, accuracy@4: 0.4705, time: 0:00:10\n",
            "INFO:root:Epoch: 7, train loss: 4.6564, valid loss: 4.3767, accuracy@1: 0.2616, accuracy@4: 0.4762, time: 0:00:10\n",
            "INFO:root:Epoch: 8, train loss: 4.5616, valid loss: 4.3178, accuracy@1: 0.2656, accuracy@4: 0.4827, time: 0:00:10\n",
            "INFO:root:Epoch: 9, train loss: 4.4795, valid loss: 4.2691, accuracy@1: 0.2693, accuracy@4: 0.4856, time: 0:00:10\n",
            "INFO:root:Epoch: 10, train loss: 4.4048, valid loss: 4.2281, accuracy@1: 0.2707, accuracy@4: 0.4912, time: 0:00:10\n",
            "INFO:root:Epoch: 11, train loss: 4.3420, valid loss: 4.1919, accuracy@1: 0.2751, accuracy@4: 0.4960, time: 0:00:10\n",
            "INFO:root:Epoch: 12, train loss: 4.2834, valid loss: 4.1604, accuracy@1: 0.2774, accuracy@4: 0.4993, time: 0:00:10\n",
            "INFO:root:Epoch: 13, train loss: 4.2330, valid loss: 4.1340, accuracy@1: 0.2801, accuracy@4: 0.5013, time: 0:00:10\n",
            "INFO:root:Epoch: 14, train loss: 4.1845, valid loss: 4.1107, accuracy@1: 0.2803, accuracy@4: 0.5036, time: 0:00:10\n",
            "INFO:root:Epoch: 15, train loss: 4.1393, valid loss: 4.0907, accuracy@1: 0.2835, accuracy@4: 0.5071, time: 0:00:10\n",
            "INFO:root:Epoch: 16, train loss: 4.0979, valid loss: 4.0717, accuracy@1: 0.2835, accuracy@4: 0.5080, time: 0:00:10\n",
            "INFO:root:Epoch: 17, train loss: 4.0580, valid loss: 4.0543, accuracy@1: 0.2852, accuracy@4: 0.5098, time: 0:00:10\n",
            "INFO:root:Epoch: 18, train loss: 4.0199, valid loss: 4.0407, accuracy@1: 0.2855, accuracy@4: 0.5109, time: 0:00:10\n",
            "INFO:root:Epoch: 19, train loss: 3.9865, valid loss: 4.0270, accuracy@1: 0.2851, accuracy@4: 0.5133, time: 0:00:10\n",
            "INFO:root:Epoch: 20, train loss: 3.9540, valid loss: 4.0180, accuracy@1: 0.2874, accuracy@4: 0.5133, time: 0:00:10\n",
            "INFO:root:Epoch: 21, train loss: 3.9215, valid loss: 4.0081, accuracy@1: 0.2890, accuracy@4: 0.5144, time: 0:00:11\n",
            "INFO:root:Epoch: 22, train loss: 3.8933, valid loss: 4.0029, accuracy@1: 0.2885, accuracy@4: 0.5165, time: 0:00:10\n",
            "INFO:root:Epoch: 23, train loss: 3.8625, valid loss: 3.9957, accuracy@1: 0.2904, accuracy@4: 0.5182, time: 0:00:10\n",
            "INFO:root:Epoch: 24, train loss: 3.8340, valid loss: 3.9880, accuracy@1: 0.2896, accuracy@4: 0.5191, time: 0:00:10\n",
            "INFO:root:Epoch: 25, train loss: 3.8084, valid loss: 3.9869, accuracy@1: 0.2921, accuracy@4: 0.5210, time: 0:00:10\n",
            "INFO:root:Epoch: 26, train loss: 3.7812, valid loss: 3.9837, accuracy@1: 0.2915, accuracy@4: 0.5202, time: 0:00:10\n",
            "INFO:root:Epoch: 27, train loss: 3.7551, valid loss: 3.9810, accuracy@1: 0.2932, accuracy@4: 0.5226, time: 0:00:10\n",
            "INFO:root:Epoch: 28, train loss: 3.7327, valid loss: 3.9768, accuracy@1: 0.2928, accuracy@4: 0.5220, time: 0:00:10\n",
            "INFO:root:Epoch: 29, train loss: 3.7080, valid loss: 3.9774, accuracy@1: 0.2949, accuracy@4: 0.5225, time: 0:00:10\n",
            "INFO:root:Epoch: 30, train loss: 3.6862, valid loss: 3.9747, accuracy@1: 0.2943, accuracy@4: 0.5242, time: 0:00:10\n",
            "INFO:root:Epoch: 31, train loss: 3.6644, valid loss: 3.9738, accuracy@1: 0.2946, accuracy@4: 0.5238, time: 0:00:10\n",
            "INFO:root:Epoch: 32, train loss: 3.6413, valid loss: 3.9760, accuracy@1: 0.2943, accuracy@4: 0.5247, time: 0:00:10\n",
            "INFO:root:Epoch: 33, train loss: 3.6195, valid loss: 3.9774, accuracy@1: 0.2951, accuracy@4: 0.5250, time: 0:00:10\n",
            "INFO:root:Epoch: 34, train loss: 3.5992, valid loss: 3.9797, accuracy@1: 0.2956, accuracy@4: 0.5255, time: 0:00:10\n",
            "INFO:root:Epoch: 35, train loss: 3.5792, valid loss: 3.9818, accuracy@1: 0.2953, accuracy@4: 0.5242, time: 0:00:10\n",
            "INFO:root:Epoch: 36, train loss: 3.5594, valid loss: 3.9881, accuracy@1: 0.2944, accuracy@4: 0.5244, time: 0:00:10\n",
            "INFO:root:Epoch: 37, train loss: 3.5375, valid loss: 3.9928, accuracy@1: 0.2965, accuracy@4: 0.5243, time: 0:00:10\n",
            "INFO:root:Epoch: 38, train loss: 3.5188, valid loss: 3.9923, accuracy@1: 0.2949, accuracy@4: 0.5257, time: 0:00:10\n",
            "INFO:root:Epoch: 39, train loss: 3.5020, valid loss: 4.0010, accuracy@1: 0.2959, accuracy@4: 0.5263, time: 0:00:10\n",
            "INFO:root:Epoch: 40, train loss: 3.4839, valid loss: 4.0030, accuracy@1: 0.2948, accuracy@4: 0.5245, time: 0:00:10\n",
            "INFO:root:Epoch: 41, train loss: 3.4647, valid loss: 4.0109, accuracy@1: 0.2955, accuracy@4: 0.5267, time: 0:00:10\n",
            "INFO:root:Epoch: 42, train loss: 3.4490, valid loss: 4.0153, accuracy@1: 0.2948, accuracy@4: 0.5243, time: 0:00:10\n",
            "INFO:root:Epoch: 43, train loss: 3.4294, valid loss: 4.0197, accuracy@1: 0.2969, accuracy@4: 0.5267, time: 0:00:10\n",
            "INFO:root:Epoch: 44, train loss: 3.4167, valid loss: 4.0207, accuracy@1: 0.2961, accuracy@4: 0.5263, time: 0:00:10\n",
            "INFO:root:Epoch: 45, train loss: 3.3989, valid loss: 4.0299, accuracy@1: 0.2979, accuracy@4: 0.5276, time: 0:00:10\n",
            "INFO:root:Epoch: 46, train loss: 3.3819, valid loss: 4.0365, accuracy@1: 0.2944, accuracy@4: 0.5255, time: 0:00:10\n",
            "INFO:root:Epoch: 47, train loss: 3.3679, valid loss: 4.0446, accuracy@1: 0.2953, accuracy@4: 0.5262, time: 0:00:10\n",
            "INFO:root:Epoch: 48, train loss: 3.3520, valid loss: 4.0489, accuracy@1: 0.2973, accuracy@4: 0.5258, time: 0:00:10\n",
            "INFO:root:Epoch: 49, train loss: 3.3401, valid loss: 4.0523, accuracy@1: 0.2963, accuracy@4: 0.5254, time: 0:00:10\n"
          ],
          "name": "stderr"
        }
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "xss1pOYJ9WXZ"
      },
      "source": [
        "# Analyze model results"
      ]
    },
    {
      "cell_type": "code",
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 164,
          "referenced_widgets": [
            "37ada2063da14a9d9fb63a58488a1b6b",
            "c0b28de6b5254a5ca764450659f91f7d",
            "9cf9c28d13bb4adb886d0a10e771c7db",
            "01b0eab7072c4fcc94c34102b474e0e0",
            "7b154958d1c744979744841699a14c39",
            "7bbe4c6f94504c7298aed108b337636c",
            "276ca60861984fa395638bfebb3defcd",
            "5ff969a3233a4744926b19261e0ca545",
            "b980f1569596476692f3329ac30ec60d",
            "1fa23d0a28314588b779beabba577ac4",
            "f406480c1765418483ea1b768298fb31",
            "a91b418b0e894206841cafd68c76635c",
            "788c6f7099f8444785db00983185b0df",
            "9392caa43a4c4842b1ee36fc2ae00751",
            "1bd0533125e54322ae6557f0a3ffb9ee",
            "1b42fd520cba4ddb9263be73db927a17",
            "e0bc13a423a24c7dab8d89b200493636",
            "4e029ce08999477088fd14376d37e4a9",
            "bdf2d48c1386444c9d70fd6fedf57ba3",
            "5ccf2e8f6ca745c0a95bfd3d9646dad4",
            "ba5f6c7eb1fd4c66b642a4056766ec2d",
            "00c49dd5296d4203bc5cb618593b7c1d"
          ]
        },
        "id": "CfACR-of9TpT",
        "outputId": "375f00e5-8947-43ec-9280-1c975bcab5b6"
      },
      "source": [
        "results, acc_dict = get_model_performance_data(test_set, de)\n",
        "filter_results_table(results)"
      ],
      "execution_count": null,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "application/vnd.jupyter.widget-view+json": {
              "model_id": "37ada2063da14a9d9fb63a58488a1b6b",
              "version_minor": 0,
              "version_major": 2
            },
            "text/plain": [
              "  0%|          | 0/5588 [00:00<?, ?it/s]"
            ]
          },
          "metadata": {
            "tags": []
          }
        },
        {
          "output_type": "display_data",
          "data": {
            "application/vnd.jupyter.widget-view+json": {
              "model_id": "a91b418b0e894206841cafd68c76635c",
              "version_minor": 0,
              "version_major": 2
            },
            "text/plain": [
              "  0%|          | 0/1 [00:00<?, ?it/s]"
            ]
          },
          "metadata": {
            "tags": []
          }
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>model_type</th>\n",
              "      <th>recurrent_type</th>\n",
              "      <th>tie_embedding_and_projection</th>\n",
              "      <th>weight_type</th>\n",
              "      <th>accuracy@1</th>\n",
              "      <th>accuracy@4</th>\n",
              "      <th>accuracy@10</th>\n",
              "      <th>hash</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>MANY_TO_MANY</td>\n",
              "      <td>GRU</td>\n",
              "      <td>True</td>\n",
              "      <td>UNWEIGHTED</td>\n",
              "      <td>0.306013</td>\n",
              "      <td>0.519685</td>\n",
              "      <td>0.649606</td>\n",
              "      <td>0962b86e</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>"
            ],
            "text/plain": [
              "     model_type recurrent_type  ... accuracy@10      hash\n",
              "0  MANY_TO_MANY            GRU  ...    0.649606  0962b86e\n",
              "\n",
              "[1 rows x 8 columns]"
            ]
          },
          "metadata": {
            "tags": []
          },
          "execution_count": 14
        }
      ]
    },
    {
      "cell_type": "code",
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 458
        },
        "id": "eeTfKasM9hqH",
        "outputId": "b96cf1aa-4834-43f2-ff39-4d250b2ce529"
      },
      "source": [
        "get_plot_from_accuracy(single=acc_dict[(model_hash, 'single')])"
      ],
      "execution_count": null,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "image/png": "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gwIAcCsKLLx58+YpLCxMoaGheuONN3TlyhVJUl5envbs2SNJWrlypfLy8tS1a9fiTQsAwE0q8EO4devWqXv37pKkGjVqyG63KywsTCaTyTGrGzx4sL744oviTQrgluXmXnF3hOsqqblweylwhpeeni6r1SpJ+te//qWvvvpKFotFLVq0UEREhF588UUFBQUpKSmp2MMCuDUWi6eGj57q7hjXmBI7zN0RYAAFzvC8vb2VmZkpSfLw8NAvv/wiSUpKStLly5clXf2c74477ijGmABQcmeCJTUX8itwhvf3v/9d69ev12OPPaZhw4bpmWee0Z133qkTJ04oJiZGkrRlyxaFhIQUe1gAxsYMFbeiwMLr16+foqKi1LZtW3Xu3FktW7bUsWPHVLt2bVWqVEmZmZl677339N5777kiLwAAN6XAQ5p33XWXXnvtNT355JNau3atypUrp4YNG6p8+fJat26dnnjiCQ0dOlT169d3RV4AAG6KU18879Chg+6++27NnTtXU6dePZxgMpnUpEkTTZ8+Xffcc0+xhgQA4FY5fWmxu+66SxMnTizOLAAAFBunL4b5wgsvaMOGDcrNzS3OPAAAFAunCy8kJETvv/++WrVqpZiYGMdVVgAAKA2cLrxnnnlGy5cv14IFC1SxYkUNGzZMHTp00IwZM7ghLAAUoKR+V6+k5ioOhb4f3j333KNhw4YpNDRUsbGxev/99zVv3jw1aNBA0dHRnK0JANfBdwjdr1CFd/jwYa1atUrx8fGyWCyKiIhQRESEfHx8tHDhQg0aNEgbN24srqwAANw0pwuvW7duSk5OVufOnTV16lQ1atQo3/PPPPOMPvvssyIPCABAUXC68KKiotSmTRt5eXndcAyzOwBASeX0SSve3t5KTk7Ot+zw4cPavn17kYcCAKCoOV14sbGxKl++fL5l5cuXV2xsbJGHwu2vpJ4ZVlJzAbh1Th/SzMrKkr+/f75l/v7+OnXqVJGHwu2PM9YAuJrTM7xatWrpu+++y7ds586dqlmzZpGHAgCgqDk9wxs8eLCGDBmiHj16qFatWjpx4oSWLVumCRMmOLX+kSNHFB0drZycHFWuXFlxcXGqU6dOvjHTp0/XwoULHTPJpk2bOu65Fx0drW+//VZVqlSRJIWFhen55593Nj4AwOCcLrx27drp448/1pIlS7R582ZVr15dH374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IbLZbMrLy1O9evX0+uuvy9/f393RnHLixAmNHDlSOTk58vT01EsvvaTQ0FB3xyqUjh07atSoUXrooYfcHaVQVq1apblz5zpOGBo6dKjatWvn5lTOGTVqlPbs2aPc3Fy1bNlSI0eOvO6NTkuK8ePHa926dcrMzFSVKlVUuXJlrVmzRklJSYqOjtaZM2dUsWJFxcXF6a677ir2PBQeAMAQOKQJADAECg8AYAgUHgDAECg8AIAhUHgAAEOg8ADkc9999+nYsWMuf92dO3eWuq84oHSh8IDr+OGHH9SnTx8FBwerefPm6tOnj/bu3evuWLcVdxUrjIuLRwN/cu7cOQ0cOFBjxoxRp06dlJubqx9++EFeXl7ujgbgFjDDA/7k92tahoeHy2w264477lCrVq1Uv359x5glS5aoU6dOatasmfr166fk5GTHc9u3b1dYWJiCg4MVGxurJ554QosXL5YkTZ8+Xa+++qpj7MmTJ3XffffpypUrkq7ermbkyJFq1aqVHnzwQb399tuOaw4uW7ZMjz32mOLi4tSsWTO1adNGmzdvdmwrJydH//znP9WqVSs1a9ZMgwYNcjy3adMmRUREKCQkRH369NGBAwecei8uX76suLg4tW7dWg888IBGjx6t3377TdL/H4L8+OOP1aJFC7Vq1UpLly51rPvrr79q4MCBatq0qbp37663335bjz32mCTp8ccflyRFRESoSZMmWrt2rWO9G20PuFUUHvAndevWldls1ogRI7R582adPn063/MbNmzQBx98oBkzZui7775TcHCwhg0bJknKzs7W4MGD9dJLL2nHjh268847C3VR6+joaHl6emrdunVasWKFtm/f7ihLSdq7d6/q1q2rHTt2qH///ho1apR+v1jSa6+9posXL2rNmjX69ttv9fTTT0uSEhMTNXLkSMXGxmrnzp3q3bu3Bg0apMuXLxeY56233tKRI0e0YsUKrVu3ThkZGXr//fcdz2dmZurs2bPasmWL3nzzTcXGxjrer9jYWJUtW1bbt29XXFycVqxY4Vjv888/lyStXLlSP/74ozp37lzg9oBbReEBf+Lt7a2FCxfKw8NDb7zxhlq0aKGBAwcqMzNTkvTFF18oKipK9erVk6enpwYOHKj9+/crOTlZW7Zs0T333KOwsDBZLBb94x//cPrmrpmZmdq8ebNGjhypcuXKydfXV08//bTWrFnjGBMQEKBevXrJbDbr0Ucf1alTp5SZmamMjAxt2bJFY8eOVaVKlWSxWNS8eXNJ0qJFi9S7d281atTIsZ7FYtF//vOfv8xjt9v1r3/9SyNHjlTlypXl7e2t5557Ll8eT09PvfDCC7JYLAoNDVW5cuV05MgR2Ww2rVu3TkOGDFHZsmV19913KzIyssD34EbbA4oCn+EB11GvXj1NmjRJ0tUr6g8fPlwTJkzQtGnTlJKSogkTJiguLs4x3m63Kz09XRkZGapevbpjuYeHh9O3PUlJSdGVK1fy3bEiLy8v3/p/LM+yZctKunrniNOnT6tSpUqqVKnSdbe7YsUKLViwwLEsNzdXGRkZf5knOztbFy9eVLdu3fLtZ15enuNx5cqV5en5/39GypYtqwsXLig7O1tXrlzJl92Z9+FG2wOKAoUHFKBevXrq1q2bFi1aJOnqH+6BAweqa9eu14w9duyY0tLSHI/tdnu+W0iVLVvW8RmYJMesUbp66xovLy/t2LEj3x99Z1SvXl2nT592XH3+j37P+/zzzxdqm1WqVNEdd9yhNWvWqFq1aoVa18fHR56enkpLS1PdunUlKd/7ALgDhzSBP0lKStLHH3/sKK7U1FTFx8erUaNGkqQ+ffpozpw5OnTokKSrJ5p8+eWXkqTQ0FAdOnRI69at05UrVzR//vx8pRYYGKhdu3YpJSVFZ8+e1QcffOB4zt/fXy1bttSkSZN07tw55eXl6fjx4/r+++8LzOzv76+HHnpIY8eO1enTp5Wbm6tdu3ZJknr27KkvvvhCP/30k+x2uy5cuKBvvvmmwDusm0wm9ezZUxMmTFBWVpakqzd93bp1a4F5zGaz2rdvrxkzZujixYtKSkrSypUr842pWrWqTpw4UeC2gKJC4QF/4u3trZ9++kk9e/ZU48aN1atXL917772Kjo6WJLVv3179+/fXK6+8oqZNmyo8PFxbtmyRdHVm8+6772rq1Km6//77dezYMTVt2tSx7ZYtW6pz587q2rWrunXrpocffjjfa0+ePFm5ubnq3LmzmjVrpqFDhzpu+lmQyZMny9PTU506ddIDDzygTz/9VJLUoEEDjRs3TrGxsWrWrJk6dOigZcuWObXN4cOHq3bt2urVq5eaNm2qp59+2unP1EaPHq2zZ8+qZcuWeu211/TII4/k+2rH4MGDFR0drZCQkHxnaQLFhfvhAcXsySefVNeuXdWzZ093R3GrKVOmKDMzM99nn4ArMcMDUCySkpJ04MAB2e127d27V0uWLFH79u3dHQsGxkkrAIrF+fPnNWzYMGVkZMjX11fPPvus2rZt6+5YMDAOaQIADIFDmgAAQ6DwAACGQOEBAAyBwgMAGAKFBwAwBAoPAGAI/wfwUhelSyXEcQAAAABJRU5ErkJggg==\n",
            "text/plain": [
              "<Figure size 432x432 with 1 Axes>"
            ]
          },
          "metadata": {
            "tags": []
          }
        }
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "oE4rMFIt9mES"
      },
      "source": [
        "# Build submission from single model"
      ]
    },
    {
      "cell_type": "code",
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 98,
          "referenced_widgets": [
            "d87c77b2cbc0411497a0fc4d4fa6f4c7",
            "e76825ffcd2b4c79b3b4a186f5b2acc3",
            "f92b8eb045804966939a12564e3e0422",
            "d607eba6cd83431ba84cfda5f9c4a7fc",
            "a122d4de38ae459a99d5af04f960511f",
            "c9751caa858144b08333125c2ed56440",
            "01e0e2c9287841e4a38b71077ae02fb7",
            "2df24964a3fa4f96a74851b2a3cf6eb8",
            "9fe53ebf98c94acb9299e6b42e53dece",
            "a907477fedf04269997b4c4828775ddc",
            "75b8063e10ff4ebba6052d325b53ecab",
            "e9d7c5aed3704ad383dbff12fea51307",
            "4f3996f881974ba6a3ec9d6abba22941",
            "ce673c5aa2ed4c3b9e43b72738833dde",
            "18236481cf85448fb7ef14803a9090b9",
            "871401a05b9c4854b7ddfefb70b359f2",
            "6686209091af489583a132973cf86048",
            "b7dd2d9318a74c6da16f7faf5536e7c3",
            "6e37be5dd8ec432d8a74e8b6b21dfccb",
            "94689ac2ca7f4110bf33e5fd3fe4d22e",
            "510714ae65bc49a1a8f8029ea2376d26",
            "16e9d535efd84dcf96253adfe53f6c14"
          ]
        },
        "id": "oxOBThDb9kZ7",
        "outputId": "a314df64-2058-4378-cef1-10ceba1ea03d"
      },
      "source": [
        "get_final_submission(submission_set, model_hash, de)"
      ],
      "execution_count": null,
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "application/vnd.jupyter.widget-view+json": {
              "model_id": "d87c77b2cbc0411497a0fc4d4fa6f4c7",
              "version_minor": 0,
              "version_major": 2
            },
            "text/plain": [
              "  0%|          | 0/70662 [00:00<?, ?it/s]"
            ]
          },
          "metadata": {
            "tags": []
          }
        },
        {
          "output_type": "display_data",
          "data": {
            "application/vnd.jupyter.widget-view+json": {
              "model_id": "e9d7c5aed3704ad383dbff12fea51307",
              "version_minor": 0,
              "version_major": 2
            },
            "text/plain": [
              "  0%|          | 0/1 [00:00<?, ?it/s]"
            ]
          },
          "metadata": {
            "tags": []
          }
        },
        {
          "output_type": "stream",
          "text": [
            "INFO:root:Passed all sanity checks!\n"
          ],
          "name": "stderr"
        }
      ]
    }
  ]
}